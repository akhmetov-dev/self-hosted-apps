# v2raya

## Конфигурация
```yml
services:
  v2raya:
    image: mzz2017/v2raya:latest
    restart: always
    privileged: true
    network_mode: host
    volumes:
      - /lib/modules:/lib/modules:ro
      - /etc/v2raya:/etc/v2raya
      - ./v2raya/geo:/usr/local/share/xray
```

## Полезные ссылки
1) [Интернет-цензура и обход блокировок: не время расслабляться](https://habr.com/ru/articles/710980/)
2) [Современные технологии обхода блокировок: V2Ray, XRay, XTLS, Hysteria, Cloak и все-все-все](https://habr.com/ru/articles/727868/)
3) [Bleeding-edge обход блокировок с полной маскировкой: настраиваем сервер и клиент XRay с XTLS-Reality быстро и просто](https://habr.com/ru/articles/731608/)
4) [Обход блокировок на OpenWRT с помощью v2rayA (xray-core) и баз GeoIP, Geosite Re:filter, Antifilter](https://habr.com/ru/articles/773696/)
5) Настройка маршрутизации. Предопределенные списки доменов
    - [базовый список (встроен в xray, скачивать дополнительно нет необходимости)](https://xtls.github.io/ru/config/routing.html#ruleobject)
    - [полный международный список](https://github.com/v2fly/domain-list-community)
    - [список для рунета](https://github.com/runetfreedom/russia-v2ray-rules-dat?tab=readme-ov-file)
6) [xray](https://github.com/XTLS/Xray-core)
7) [v2rayA](https://github.com/v2rayA/v2rayA)
8) ["one click"-скрипт, упрощающий установку xray-core на сервер](https://github.com/zxcvos/Xray-script)

## Введение
Данная инструкция описывает настройку связки Xray и v2rayA на выделенном сервере в локальной сети, который выступает в роли шлюза по умолчанию для выбранных устройств. Это позволяет автоматически перенаправлять их трафик через сервер, исключая необходимость установки отдельного прокси-клиента на каждое устройство локальной сети.

Чтобы понимать контекст и возможности данного стека, рекомендуется ознакомиться с представленными ниже материалами:
Статьи 1 и 2 подробно описывают современный ландшафт интернет-цензуры. Они объясняют, почему старые методы становятся менее эффективными, и как работают новые технологии.
Статья 3 - это практический разбор XTLS-Reality и базовая инструкция по установке xray-core на сервере и на клиенте.
В статье 4 решается похожая задача но другим способом - настройка xray + v2raya на уровне роутера. У данного способа есть ограничение - нужен действительно мощный роутер с прошивкой openwrt.
Важнейшая часть настройки - разделение трафика. Не гнать весь домашний трафик в туннель, а проксировать только заблокированные ресурсы. Статья 5 содержит документацию по правилам маршрутизации и предопределенным спискам. Для гибкой настройки маршрутизации используются файлы geoip и geosite, содержащие актуальные списки сайтов, разбитые по категориям, чтобы точно определять, куда отправить запрос - напрямую или в туннель.
Ссылки 6 и 7 ведут на официальные репозитории проектов, где можно отследить актуальные версии и изменения.
Ссылка 8 ведет на shell-скрипт для быстрой установки и управления Xray без ручного редактирования конфигов. Позволяет в интерактивном режиме развернуть популярные схемы вроде VLESS‑Vision‑REALITY, VLESS‑XHTTP‑REALITY и Trojan‑XHTTP‑REALITY.

{% include mermaid.html %}
